-- Simplified bytecode test

function testCombined()
   local guest = nil
   local result = guest?.profile?.name ? "Guest"
   return result
end

function testSplit()
   local guest = nil
   local step1 = guest?.profile?.name
   local step2 = step1 ? "Guest"
   return step2
end

function testSimpleIfEmpty()
   local val = nil
   local result = val ? "Default"
   return result
end

function testSafeNavOnly()
   local guest = nil
   local result = guest?.profile?.name
   return result
end

-- Run tests
print("Test 1 (combined): " .. tostring(testCombined()))
print("Test 2 (split): " .. tostring(testSplit()))
print("Test 3 (simple): " .. tostring(testSimpleIfEmpty()))
print("Test 4 (safe nav): " .. tostring(testSafeNavOnly()))

-- Get bytecode
local mSys = mod.load('core')
local log = mSys.script.mtDebugLog({ disasm=true, funcinfo=true })
print("\n=== BYTECODE ===")
print(log)
