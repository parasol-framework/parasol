<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="-//W3C//DTD XHTML 1.1//EN" xml:lang="en" xsi:schemaLocation="http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><script type="text/javascript" async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8254DG7MT6"> </script><script type="text/javascript">
	   window.dataLayer = window.dataLayer || [];
	   function gtag(){dataLayer.push(arguments);}
	   gtag('js', new Date());
      gtag('config', 'G-8254DG7MT6');</script><meta name="viewport" content="width=device-width, initial-scale=1"></meta><meta name="description" content="Parasol Framework documentation, machine generated from source"></meta><meta name="author" content="Paul Manias"></meta><link rel="icon" href="/favicon.ico"></link><title>Parasol Framework Manual</title><link href="../../css/bootstrap.min.css" rel="stylesheet"></link><link href="../../css/module-template.css" rel="stylesheet"></link><script type="text/javascript">
          var shiftWindow = function() { scrollBy(0, -100) };
          window.addEventListener("hashchange", shiftWindow);
          function load() { if (window.location.hash) shiftWindow(); }
        </script></head><body><nav class="navbar navbar-expand-sm navbar-dark bg-dark"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="../../index.html">Parasol Framework</a></div><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div id="navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="nav-item"><a class="nav-link" href="../../gallery.html">Gallery</a></li><li class="nav-item"><a class="nav-link" href="../api.html">API</a></li><li class="nav-item"><a class="nav-link" href="../../wiki/Home.html">Wiki</a></li><li class="nav-item"><a class="nav-link" href="https://github.com/parasol-framework/parasol">GitHub</a></li></ul></div></div></nav>
<div class="container-fluid"><div class="row"><div class="d-sm-block d-none col-3 sidebar" style="max-width: 230px;"><div class="flex-shrink-1 pt-2 pe-2 sticky-top overflow-auto vh-100 b-shadow">
<ul class="list-unstyled"><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#mod-collapse" aria-expanded="false">Modules</button><div class="collapse" id="mod-collapse"><ul class="btn-toggle-nav list-unstyled fw-normal"><li class="api-ref"><a class="rounded" href="../audio.html">Audio</a></li><li class="api-ref"><a class="rounded" href="../core.html">Core</a></li><li class="api-ref"><a class="rounded" href="../display.html">Display</a></li><li class="api-ref"><a class="rounded" href="../fluid.html">Fluid</a></li><li class="api-ref"><a class="rounded" href="../font.html">Font</a></li><li class="api-ref"><a class="rounded" href="../network.html">Network</a></li><li class="api-ref"><a class="rounded" href="../vector.html">Vector</a></li></ul></div></li></ul>
<ul class="list-unstyled"><li class="border-top my-3"></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#audio-collapse" aria-expanded="false">Audio</button><div class="collapse" id="audio-collapse"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1"><li class="api-ref"><a class="rounded" href="audio.html">Audio</a></li><li class="api-ref"><a class="rounded" href="sound.html">Sound</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#core-collapse" aria-expanded="false">Core</button><div class="collapse" id="core-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="file.html">File</a></li><li class="api-ref"><a class="rounded" href="metaclass.html">MetaClass</a></li><li class="api-ref"><a class="rounded" href="module.html">Module</a></li><li class="api-ref"><a class="rounded" href="storagedevice.html">StorageDevice</a></li><li class="api-ref"><a class="rounded" href="task.html">Task</a></li><li class="api-ref"><a class="rounded" href="thread.html">Thread</a></li><li class="api-ref"><a class="rounded" href="time.html">Time</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#data-collapse" aria-expanded="false">Data</button><div class="collapse" id="data-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="compression.html">Compression</a></li><li class="api-ref"><a class="rounded" href="config.html">Config</a></li><li class="api-ref"><a class="rounded" href="script.html">Script</a></li><li class="api-ref"><a class="rounded" href="xml.html">XML</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#devices-collapse" aria-expanded="false">Devices</button><div class="collapse" id="devices-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="controller.html">Controller</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#effects-collapse" aria-expanded="false">Effects</button><div class="collapse" id="effects-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="blurfx.html">BlurFX</a></li><li class="api-ref"><a class="rounded" href="colourfx.html">ColourFX</a></li><li class="api-ref"><a class="rounded" href="compositefx.html">CompositeFX</a></li><li class="api-ref"><a class="rounded" href="convolvefx.html">ConvolveFX</a></li><li class="api-ref"><a class="rounded" href="displacementfx.html">DisplacementFX</a></li><li class="api-ref"><a class="rounded" href="filtereffect.html">FilterEffect</a></li><li class="api-ref"><a class="rounded" href="floodfx.html">FloodFX</a></li><li class="api-ref"><a class="rounded" href="imagefx.html">ImageFX</a></li><li class="api-ref"><a class="rounded" href="lightingfx.html">LightingFX</a></li><li class="api-ref"><a class="rounded" href="mergefx.html">MergeFX</a></li><li class="api-ref"><a class="rounded" href="morphologyfx.html">MorphologyFX</a></li><li class="api-ref"><a class="rounded" href="offsetfx.html">OffsetFX</a></li><li class="api-ref"><a class="rounded" href="remapfx.html">RemapFX</a></li><li class="api-ref"><a class="rounded" href="sourcefx.html">SourceFX</a></li><li class="api-ref"><a class="rounded" href="turbulencefx.html">TurbulenceFX</a></li><li class="api-ref"><a class="rounded" href="wavefunctionfx.html">WaveFunctionFX</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#ext-collapse" aria-expanded="false">Extensions</button><div class="collapse" id="ext-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="scintilla.html">Scintilla</a></li><li class="api-ref"><a class="rounded" href="scintillasearch.html">ScintillaSearch</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#gfx-collapse" aria-expanded="false">Graphics</button><div class="collapse" id="gfx-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="bitmap.html">Bitmap</a></li><li class="api-ref"><a class="rounded" href="clipboard.html">Clipboard</a></li><li class="api-ref"><a class="rounded" href="display.html">Display</a></li><li class="api-ref"><a class="rounded" href="document.html">Document</a></li><li class="api-ref"><a class="rounded" href="font.html">Font</a></li><li class="api-ref"><a class="rounded" href="picture.html">Picture</a></li><li class="api-ref"><a class="rounded" href="pointer.html">Pointer</a></li><li class="api-ref"><a class="rounded" href="surface.html">Surface</a></li><li class="api-ref"><a class="rounded" href="svg.html">SVG</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#net-collapse" aria-expanded="false">Network</button><div class="collapse" id="net-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="clientsocket.html">ClientSocket</a></li><li class="api-ref"><a class="rounded" href="http.html">HTTP</a></li><li class="api-ref"><a class="rounded" href="netsocket.html">NetSocket</a></li><li class="api-ref"><a class="rounded" href="proxy.html">Proxy</a></li></ul></div></li>
<li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#vectors-collapse" aria-expanded="false">Vectors</button><div class="collapse" id="vectors-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="vector.html">Vector</a></li><li class="api-ref"><a class="rounded" href="vectorclip.html">VectorClip</a></li><li class="api-ref"><a class="rounded" href="vectorcolour.html">VectorColour</a></li><li class="api-ref"><a class="rounded" href="vectorellipse.html">VectorEllipse</a></li><li class="api-ref"><a class="rounded" href="vectorfilter.html">VectorFilter</a></li><li class="api-ref"><a class="rounded" href="vectorgradient.html">VectorGradient</a></li><li class="api-ref"><a class="rounded" href="vectorgroup.html">VectorGroup</a></li><li class="api-ref"><a class="rounded" href="vectorimage.html">VectorImage</a></li><li class="api-ref"><a class="rounded" href="vectorpath.html">VectorPath</a></li><li class="api-ref"><a class="rounded" href="vectorpattern.html">VectorPattern</a></li><li class="api-ref"><a class="rounded" href="vectorpolygon.html">VectorPolygon</a></li><li class="api-ref"><a class="rounded" href="vectorrectangle.html">VectorRectangle</a></li><li class="api-ref"><a class="rounded" href="vectorscene.html">VectorScene</a></li><li class="api-ref"><a class="rounded" href="vectorshape.html">VectorShape</a></li><li class="api-ref"><a class="rounded" href="vectorspiral.html">VectorSpiral</a></li><li class="api-ref"><a class="rounded" href="vectortext.html">VectorText</a></li><li class="api-ref"><a class="rounded" href="vectortransition.html">VectorTransition</a></li><li class="api-ref"><a class="rounded" href="vectorviewport.html">VectorViewport</a></li><li class="api-ref"><a class="rounded" href="vectorwave.html">VectorWave</a></li></ul></div></li></ul></div></div>
<div class="col-sm-9" style="max-width: 1200px;"><div class="docs-content" style="display:none;" id="default-page"><div class="page-header"><h1>Clipboard Class</h1></div><p class="lead">The Clipboard class manages cut, copy and paste between applications.</p>
<p>The Clipboard class manages data transfer between applications on behalf of the user.  Depending on the host system, behaviour between platforms can vary.</p>
<p>On Windows the clipboard is tightly integrated by default, allowing it to support native Windows applications.  This reduces the default feature set, but ensures that the clipboard behaves in a way that the user would expect it to. If historical buffering is enabled with the <code>CPF::HISTORY_BUFFER</code> option then the clipboard API will actively monitor the clipboard and store copied data in the local <code>clipboard:</code> file cache.  This results in additional overhead to clipboard management.</p>
<p>On Linux the clipboard is localised and data is shared between Parasol applications only.</p>
<p>Multiple clipboard objects can be created, but they will share the same group of clipped data for the logged-in user.</p>
<p>There is a limit on the number of clipped items that can be stored in the clipboard.  Only 1 grouping of each datatype is permitted (for example, only one group of image clips may exist at any time).  In historical buffer mode there is a fixed limit to the clip count and the oldest members are automatically removed.</p>
<h3>Structure</h3><p>The Clipboard class consists of the following fields:</p><table class="table"><thead><th class="col-md-1"><div data-bs-toggle="tooltip" title="Read/Write access indicators are listed below">Access</div></th><th class="col-md-1">Name</th><th class="col-md-1">Type</th><th>Comment</th></thead><tbody><tr data-bs-toggle="collapse" data-bs-target="#fl-Flags" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Flags"><i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct read access"></i>
                           
                          <i class="bi bi-check-lg text-success" data-bs-toggle="tooltip" title="Immutable"></i></td><th class="col-md-1">Flags</th><td class="col-md-1"><span class="text-nowrap">CPF</span></td><td>Optional flags.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Flags" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th class="col-md-1">CPF::DRAG_DROP</th><td>Enables drag and drop mode.  The clipboard content will be private and not share data with the host system in this mode.</td></tr>
<tr><th class="col-md-1">CPF::HISTORY_BUFFER</th><td>Enables the history buffer.  Note that this results in active clipboard monitoring and the program will make copies of all potential clipboard content - whether it is used or not.</td></tr>
<tr><th class="col-md-1">CPF::HOST</th><td>This indicator is automatically set when a clipboard was created due to incoming content from the host system.</td></tr>
</tbody></table>
      
</div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#fl-RequestHandler" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-RequestHandler"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">RequestHandler</th><td class="col-md-1"><span class="text-nowrap">FUNCTION</span></td><td>Provides a hook for responding to drag and drop requests.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-RequestHandler" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>Applications can request data from a clipboard if it is in drag-and-drop mode by sending a <code>DATA::REQUEST</code> to the Clipboard's DataFeed action.  Doing so will result in a callback to the function that is referenced in the RequestHandler, which must be defined by the source application.  The RequestHandler function must follow this template:</p>
<p>
<code>ERR RequestHandler(*Clipboard, OBJECTPTR Requester, LONG Item, BYTE Datatypes[4])</code></p>
<p>The function will be expected to send a <code>DATA::RECEIPT</code> to the object referenced in the Requester paramter.  The receipt must provide coverage for the referenced Item and use one of the indicated Datatypes as the data format. If this cannot be achieved then <code>ERR::NoSupport</code> should be returned by the function.</p>
      
</div></div></td></tr>
</tbody></table><h3>Actions</h3><p>The following actions are currently supported:</p><table class="table"><tbody><tr data-bs-toggle="collapse" data-bs-target="#tac-Clear" style="scroll-margin:3em;" id="ta-Clear"><td style="width:1%; border-top-style: none; border-bottom-style: none;"></td><th class="col-md-1 text-primary">Clear</th><td>Destroys all cached data that is stored in the clipboard.</td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tac-DataFeed" style="scroll-margin:3em;" id="ta-DataFeed" role="button"><td style="width:1%; border-top-style: none; border-bottom-style: none;"><i class="bi bi-chevron-double-right text-secondary"></i></td><th class="col-md-1 text-primary">DataFeed</th><td>This action can be used to place data in a clipboard.</td></tr><tr><td class="hiddenRow" style="width:1%; border-top-style: none; border-bottom-style: none;"></td><td colspan="2" class="hiddenRow"><div id="tac-DataFeed" class="collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR acDataFeed(*Object, OBJECTID Object, DATA Datatype, APTR Buffer, LONG Size)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Object</td><td>Must refer to the unique ID of the object that you represent. If you do not represent an object, set this parameter to the current task ID.</td></tr>
<tr><td><a href="../core.html?page=DATA">Datatype</a></td><td>The type of data being sent.</td></tr>
<tr><td>Buffer</td><td>The data being sent to the target object.</td></tr>
<tr><td>Size</td><td>The size of the data in Buffer.</td></tr>
</tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>Data can be sent to a clipboard object via the DataFeed action. Currently, only the <code>DATA::TEXT</code> type is supported. All data that is sent to a clipboard object through this action will replace any stored information that matches the given data type.</p>
      
</div></div></td></tr>
</tbody></table><h3>Methods</h3><p>The following methods are currently supported:</p><table class="table"><tbody><tr data-bs-toggle="collapse" data-bs-target="#tmx-AddFile" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">AddFile</th><td id="tm-AddFile">Add files to the clipboard.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-AddFile" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR clip::AddFile(OBJECTPTR Object, CLIPTYPE Datatype, CSTRING Path, CEF Flags)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td><a href="?page=CLIPTYPE">Datatype</a></td><td>Set this argument to indicate the type of data you are copying to the clipboard.</td></tr>
<tr><td>Path</td><td>The path of the file to add.</td></tr>
<tr><td><a href="?page=CEF">Flags</a></td><td>Optional flags.</td></tr>
</tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>This method is used to add a file to the clipboard.  You are required to specify the type of data that is represented by the file. This allows the file content to be pasted by other applications that understand the data.  Adding files to the clipboard with a known datatype can be very efficient compared to other methods, as it saves loading the data into memory until the user is ready to paste the content.</p>
<p>Recognised data types are:</p>
<table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th class="col-md-1">CLIPTYPE::AUDIO</th><td>An audio clip that is recognised by the Sound class (such as wav's and mp3's).</td></tr>
<tr><th class="col-md-1">CLIPTYPE::DATA</th><td>Raw information that is uncategorised can be defined as a data clip.</td></tr>
<tr><th class="col-md-1">CLIPTYPE::FILE</th><td>Pure file references are stored as file clips.  This type is typically used by file managers for moving and copying files.</td></tr>
<tr><th class="col-md-1">CLIPTYPE::IMAGE</th><td>Images that are recognised by the Picture class may be stored as this type (such as jpeg's and png files).</td></tr>
<tr><th class="col-md-1">CLIPTYPE::OBJECT</th><td>An object that has been deserialised into binary form.</td></tr>
<tr><th class="col-md-1">CLIPTYPE::TEXT</th><td>Plain text files such as ASCII and UTF-8 must be identified through this clip type.</td></tr>
</tbody></table>
<p>Optional flags that may be passed to this method are as follows:</p>
<table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th class="col-md-1">CEF::DELETE</th><td>Requests that the original file source is deleted if a successful paste operation takes place.</td></tr>
<tr><th class="col-md-1">CEF::EXTEND</th><td>Instead of replacing existing clipboard data, add the new data to the group.</td></tr>
</tbody></table>
      
<div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>The files were added to the clipboard.</td></tr>
<tr><th class="col-md-1">MissingPath</th><td>The Files argument was not correctly specified.</td></tr>
<tr><th class="col-md-1">NullArgs</th><td>Function call missing argument value(s)</td></tr>
</tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-AddObjects" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">AddObjects</th><td id="tm-AddObjects">Extract data from objects and add it all to the clipboard.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-AddObjects" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR clip::AddObjects(OBJECTPTR Object, CLIPTYPE Datatype, OBJECTID * Objects, CEF Flags)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td><a href="?page=CLIPTYPE">Datatype</a></td><td>The type of data representing the objects, or NULL for automatic recognition.</td></tr>
<tr><td>Objects</td><td>Array of object ID's to add to the clipboard.</td></tr>
<tr><td><a href="?page=CEF">Flags</a></td><td>Optional flags.</td></tr>
</tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>Data can be saved to the clipboard directly from an object if the object's class supports the SaveToObject() action.  The clipboard will ask that the object save its data directly to a cache file, completely removing the need for the client to save the object data to an interim file for the clipboard.</p>
<p>Certain classes are recognised by the clipboard system and will be added to the correct datatype automatically (for instance, <a href="picture.html">Picture</a> objects will be put into the <code>CLIPTYPE::IMAGE</code> data category).  If an object's class is not recognised by the clipboard system then the data will be stored in the <code>CLIPTYPE::OBJECT</code> category to signify that there is a class in the system that recognises the data.  If you want to over-ride any aspect of this behaviour, force the <code>Datatype</code> parameter with one of the available <code>CLIPTYPE</code> values.</p>
<p>This method supports groups of objects in a single clip, thus requires an array of object ID's terminated with a zero entry.</p>
<p>Optional flags that may be passed to this method are the same as those specified in the <a data-bs-toggle="tooltip" title="Add files to the clipboard." href="#tm-AddFile">AddFile()</a> method.  The <code>CEF::DELETE</code> flag has no effect on objects.</p>
      
<div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>The objects were added to the clipboard.</td></tr>
<tr><th class="col-md-1">Args</th><td>Invalid arguments passed to function.</td></tr>
</tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-AddText" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">AddText</th><td id="tm-AddText">Adds a block of text to the clipboard.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-AddText" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR clip::AddText(OBJECTPTR Object, CSTRING String)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>String</td><td>The text to add to the clipboard.</td></tr>
</tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>Plain UTF-8 text can be added to the clipboard using the AddText() method.</p>
      
<div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>Operation successful.</td></tr>
<tr><th class="col-md-1">CreateFile</th><td>A new file could not be created.</td></tr>
<tr><th class="col-md-1">NullArgs</th><td>Function call missing argument value(s)</td></tr>
</tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-GetFiles" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">GetFiles</th><td id="tm-GetFiles">Retrieve the most recently clipped data as a list of files.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-GetFiles" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR clip::GetFiles(OBJECTPTR Object, CLIPTYPE Filter, LONG Index, CLIPTYPE * Datatype, CSTRING ** Files, CEF * Flags)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td><a href="?page=CLIPTYPE">Filter</a></td><td>Filter down to the specified data type.  This parameter will be updated to reflect the retrieved data type when the method returns.  Set to zero to disable.</td></tr>
<tr><td>Index</td><td>If the <code>Filter</code> parameter is zero and clipboard history is enabled, this parameter refers to a historical clipboard item, with zero being the most recent.</td></tr>
<tr><td><a href="?page=CLIPTYPE">Datatype</a></td><td>The resulting datatype of the requested clip data.</td></tr>
<tr><td>Files</td><td>The resulting location(s) of the requested clip data are returned in this parameter; terminated with a <code>NULL</code> entry.  The client must free the returned array with <a href="core.html?page=FreeResource">FreeResource()</a>.</td></tr>
<tr><td><a href="?page=CEF">Flags</a></td><td>Result flags are returned in this parameter.  If <code>DELETE</code> is defined, the client must delete the files after use in order to support the 'cut' operation.</td></tr>
</tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>This method returns a list of items that are on the clipboard.  The caller must declare the types of data that it supports (or zero if all datatypes are recognised).</p>
<p>The most recently clipped datatype is always returned.  To scan for all available clip items, set the <code>Filter</code> parameter to zero and repeatedly call this method with incremented Index numbers until the error code <code>ERR::OutOfRange</code> is returned.</p>
<p>On success this method will return a list of files (terminated with a <code>NULL</code> entry) in the <code>Files</code> parameter.  Each file is a readable clipboard entry - how the client reads it depends on the resulting <code>Datatype</code>.  Additionally, the <a href="core.html?page=IdentifyFile">IdentifyFile()</a> function could be used to find a class that supports the data.  The resulting <code>Files</code> array is a memory allocation that must be freed with a call to <a href="core.html?page=FreeResource">FreeResource()</a>.</p>
<p>If this method returns the <code>CEF::DELETE</code> flag in the <code>Flags</code> parameter, the client must delete the source files after successfully copying the data.  When cutting and pasting files within the file system, using <a href="core.html?page=MoveFile">MoveFile()</a> is recommended as the most efficient method.</p>
      
<div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>A matching clip was found and returned.</td></tr>
<tr><th class="col-md-1">Args</th><td>Invalid arguments passed to function.</td></tr>
<tr><th class="col-md-1">NoData</th><td>No clip was available that matched the requested data type.</td></tr>
<tr><th class="col-md-1">OutOfRange</th><td>The specified <code>Index</code> is out of the range of the available clip items.</td></tr>
</tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-Remove" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">Remove</th><td id="tm-Remove">Remove items from the clipboard.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-Remove" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR clip::Remove(OBJECTPTR Object, CLIPTYPE Datatype)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td><a href="?page=CLIPTYPE">Datatype</a></td><td>The datatype(s) that will be deleted (datatypes may be logically-or'd together).</td></tr>
</tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>The Remove() method will clear all items that match a specified datatype.  Clear multiple datatypes by combining flags in the <code>Datatype</code> parameter.  To clear all content from the clipboard, use the <a data-bs-toggle="tooltip" title="Destroys all cached data that is stored in the clipboard." href="#ta-Clear">Clear()</a> action instead of this method.</p>
      
<div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>Operation successful.</td></tr>
<tr><th class="col-md-1">AccessMemory</th><td>The clipboard memory data was not accessible.</td></tr>
<tr><th class="col-md-1">NullArgs</th><td>Function call missing argument value(s)</td></tr>
</tbody></table></div></div></td></tr>
</tbody></table><div class="footer copyright text-right">Clipboard class documentation © Paul Manias 2003-2025</div></div><div class="docs-content" style="display:none;" id="CEF"><h1>CEF Type</h1><p class="lead"></p><table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th>CEF::DELETE</th><td>Requests that the original file source is deleted if a successful paste operation takes place.</td></tr>
<tr><th>CEF::EXTEND</th><td>Instead of replacing existing clipboard data, add the new data to the group.</td></tr>
</tbody></table><div class="footer copyright text-right">Clipboard module documentation © Paul Manias 2003-2025</div></div>
<div class="docs-content" style="display:none;" id="CLIPTYPE"><h1>CLIPTYPE Type</h1><p class="lead">Clipboard types</p><table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th>CLIPTYPE::AUDIO</th><td>An audio clip that is recognised by the Sound class (such as wav's and mp3's).</td></tr>
<tr><th>CLIPTYPE::DATA</th><td>Raw information that is uncategorised can be defined as a data clip.</td></tr>
<tr><th>CLIPTYPE::FILE</th><td>Pure file references are stored as file clips.  This type is typically used by file managers for moving and copying files.</td></tr>
<tr><th>CLIPTYPE::IMAGE</th><td>Images that are recognised by the Picture class may be stored as this type (such as jpeg's and png files).</td></tr>
<tr><th>CLIPTYPE::OBJECT</th><td>An object that has been deserialised into binary form.</td></tr>
<tr><th>CLIPTYPE::TEXT</th><td>Plain text files such as ASCII and UTF-8 must be identified through this clip type.</td></tr>
</tbody></table><div class="footer copyright text-right">Clipboard module documentation © Paul Manias 2003-2025</div></div>
<div class="docs-content" style="display:none;" id="CPF"><h1>CPF Type</h1><p class="lead">Clipboard flags</p><table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th>CPF::DRAG_DROP</th><td>Enables drag and drop mode.  The clipboard content will be private and not share data with the host system in this mode.</td></tr>
<tr><th>CPF::HISTORY_BUFFER</th><td>Enables the history buffer.  Note that this results in active clipboard monitoring and the program will make copies of all potential clipboard content - whether it is used or not.</td></tr>
<tr><th>CPF::HOST</th><td>This indicator is automatically set when a clipboard was created due to incoming content from the host system.</td></tr>
</tbody></table><div class="footer copyright text-right">Clipboard module documentation © Paul Manias 2003-2025</div></div>
</div></div></div><script type="text/javascript" src="../../js/bootstrap.bundle.min.js"></script><script type="text/javascript" src="../../js/base.js"></script><script type="text/javascript">
const ready = fn => document.readyState !== 'loading' ? fn() : document.addEventListener('DOMContentLoaded', fn);

   var xslt = false;
   var url = window.location.pathname;
   var filename = url.substring(url.lastIndexOf('/')+1);
   if (filename.endsWith(".xml")) { // XSLT is being used to view this document
      filename = filename.substr(0, filename.length-3) + 'html';
      xslt = true;
   }

   // Auto-open the relevant sidebar branch

   var nl = document.querySelectorAll('li[class="api-ref"] > a[href="' + filename + '"]');
   if (nl.length > 0) {
      // Target the last matching element to avoid confusion with matching module names (e.g. Audio module == Audio class)
      var el = nl.item(nl.length-1)
      var parent = getParentNode(el, '[class="collapse"]');
      if (parent) new bootstrap.Collapse(parent, { show: true }); // Causes animation

      el.style.backgroundColor = '#d2f4ea';
   }

   var page = glParameters["page"];
   if (isEmpty(page)) page = glParameters["function"];
   var div = document.getElementById(page);
   if (!div) div = document.getElementById("default-page");
   if (div) div.style.display = "block";

   cancelAnimations();

ready(function(){
   // Initialise tooltips
   var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
   var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
     return new bootstrap.Tooltip(tooltipTriggerEl)
   })

   // In XSLT mode, changing all HTML links to XML is helpful for navigation (if heavy handed)
   if (xslt) {
      var nl = document.querySelectorAll('a[href*=".html"]');
      nl.forEach((el) => {
         el.href = el.href.substr(0, el.href.length-5) + '.xml'
      })
   }
});

         </script></body></html>
