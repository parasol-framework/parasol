<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8254DG7MT6"> </script><script>
	   window.dataLayer = window.dataLayer || [];
	   function gtag(){dataLayer.push(arguments);}
	   gtag('js', new Date());
      gtag('config', 'G-8254DG7MT6');</script><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Parasol Framework documentation, machine generated from source"><meta name="author" content="Paul Manias"><link rel="icon" href="/favicon.ico"><title>Parasol Framework Manual</title><link href="../../css/bootstrap.min.css" rel="stylesheet"><link href="../../css/module-template.css" rel="stylesheet"><script>
          var shiftWindow = function() { scrollBy(0, -100) };
          window.addEventListener("hashchange", shiftWindow);
          function load() { if (window.location.hash) shiftWindow(); }
        </script></head><body><nav class="navbar navbar-expand-sm navbar-dark bg-dark"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="../../index.html">Parasol Framework</a></div><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div id="navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="nav-item"><a class="nav-link" href="../../gallery.html">Gallery</a></li><li class="nav-item"><a class="nav-link" href="../api.html">API</a></li><li class="nav-item"><a class="nav-link" href="../../wiki/Home.html">Wiki</a></li><li class="nav-item"><a class="nav-link" href="https://github.com/parasol-framework/parasol">GitHub</a></li></ul></div></div></nav>
<div class="container-fluid"><div class="row"><div class="d-sm-block d-none col-3 sidebar" style="max-width: 230px;"><div class="flex-shrink-1 pt-2 pe-2 sticky-top overflow-auto vh-100 b-shadow"><ul class="list-unstyled"><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#audio-collapse" aria-expanded="false">Modules</button><div class="collapse" id="audio-collapse"><ul class="btn-toggle-nav list-unstyled fw-normal"><li class="api-ref"><a class="rounded" href="../audio.html">Audio</a></li><li class="api-ref"><a class="rounded" href="../core.html">Core</a></li><li class="api-ref"><a class="rounded" href="../display.html">Display</a></li><li class="api-ref"><a class="rounded" href="../fluid.html">Fluid</a></li><li class="api-ref"><a class="rounded" href="../font.html">Font</a></li><li class="api-ref"><a class="rounded" href="../network.html">Network</a></li><li class="api-ref"><a class="rounded" href="../vector.html">Vector</a></li></ul></div></li></ul><ul class="list-unstyled"><li class="border-top my-3"><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#audio-collapse" aria-expanded="false">Audio</button><div class="collapse" id="audio-collapse"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1"><li class="api-ref"><a class="rounded" href="audio.html">Audio</a></li><li class="api-ref"><a class="rounded" href="sound.html">Sound</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#core-collapse" aria-expanded="false">Core</button><div class="collapse" id="core-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="file.html">File</a></li><li class="api-ref"><a class="rounded" href="metaclass.html">MetaClass</a></li><li class="api-ref"><a class="rounded" href="module.html">Module</a></li><li class="api-ref"><a class="rounded" href="storagedevice.html">StorageDevice</a></li><li class="api-ref"><a class="rounded" href="task.html">Task</a></li><li class="api-ref"><a class="rounded" href="thread.html">Thread</a></li><li class="api-ref"><a class="rounded" href="time.html">Time</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#data-collapse" aria-expanded="false">Data</button><div class="collapse" id="data-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="compression.html">Compression</a></li><li class="api-ref"><a class="rounded" href="config.html">Config</a></li><li class="api-ref"><a class="rounded" href="script.html">Script</a></li><li class="api-ref"><a class="rounded" href="xml.html">XML</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#devices-collapse" aria-expanded="false">Devices</button><div class="collapse" id="devices-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="controller.html">Controller</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#effects-collapse" aria-expanded="false">Effects</button><div class="collapse" id="effects-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="blurfx.html">BlurFX</a></li><li class="api-ref"><a class="rounded" href="colourfx.html">ColourFX</a></li><li class="api-ref"><a class="rounded" href="compositefx.html">CompositeFX</a></li><li class="api-ref"><a class="rounded" href="convolvefx.html">ConvolveFX</a></li><li class="api-ref"><a class="rounded" href="displacementfx.html">DisplacementFX</a></li><li class="api-ref"><a class="rounded" href="filtereffect.html">FilterEffect</a></li><li class="api-ref"><a class="rounded" href="floodfx.html">FloodFX</a></li><li class="api-ref"><a class="rounded" href="imagefx.html">ImageFX</a></li><li class="api-ref"><a class="rounded" href="lightingfx.html">LightingFX</a></li><li class="api-ref"><a class="rounded" href="mergefx.html">MergeFX</a></li><li class="api-ref"><a class="rounded" href="morphologyfx.html">MorphologyFX</a></li><li class="api-ref"><a class="rounded" href="offsetfx.html">OffsetFX</a></li><li class="api-ref"><a class="rounded" href="remapfx.html">RemapFX</a></li><li class="api-ref"><a class="rounded" href="sourcefx.html">SourceFX</a></li><li class="api-ref"><a class="rounded" href="turbulencefx.html">TurbulenceFX</a></li><li class="api-ref"><a class="rounded" href="wavefunctionfx.html">WaveFunctionFX</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#ext-collapse" aria-expanded="false">Extensions</button><div class="collapse" id="ext-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="scintilla.html">Scintilla</a></li><li class="api-ref"><a class="rounded" href="scintillasearch.html">ScintillaSearch</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#gfx-collapse" aria-expanded="false">Graphics</button><div class="collapse" id="gfx-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="bitmap.html">Bitmap</a></li><li class="api-ref"><a class="rounded" href="clipboard.html">Clipboard</a></li><li class="api-ref"><a class="rounded" href="display.html">Display</a></li><li class="api-ref"><a class="rounded" href="document.html">Document</a></li><li class="api-ref"><a class="rounded" href="font.html">Font</a></li><li class="api-ref"><a class="rounded" href="picture.html">Picture</a></li><li class="api-ref"><a class="rounded" href="pointer.html">Pointer</a></li><li class="api-ref"><a class="rounded" href="surface.html">Surface</a></li><li class="api-ref"><a class="rounded" href="svg.html">SVG</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#net-collapse" aria-expanded="false">Network</button><div class="collapse" id="net-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="clientsocket.html">ClientSocket</a></li><li class="api-ref"><a class="rounded" href="http.html">HTTP</a></li><li class="api-ref"><a class="rounded" href="netsocket.html">NetSocket</a></li><li class="api-ref"><a class="rounded" href="proxy.html">Proxy</a></li></ul></div></li><li><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#vectors-collapse" aria-expanded="false">Vectors</button><div class="collapse" id="vectors-collapse"><ul class="btn-toggle-nav list-unstyled pb-1"><li class="api-ref"><a class="rounded" href="vector.html">Vector</a></li><li class="api-ref"><a class="rounded" href="vectorclip.html">VectorClip</a></li><li class="api-ref"><a class="rounded" href="vectorcolour.html">VectorColour</a></li><li class="api-ref"><a class="rounded" href="vectorellipse.html">VectorEllipse</a></li><li class="api-ref"><a class="rounded" href="vectorfilter.html">VectorFilter</a></li><li class="api-ref"><a class="rounded" href="vectorgradient.html">VectorGradient</a></li><li class="api-ref"><a class="rounded" href="vectorgroup.html">VectorGroup</a></li><li class="api-ref"><a class="rounded" href="vectorimage.html">VectorImage</a></li><li class="api-ref"><a class="rounded" href="vectorpath.html">VectorPath</a></li><li class="api-ref"><a class="rounded" href="vectorpattern.html">VectorPattern</a></li><li class="api-ref"><a class="rounded" href="vectorpolygon.html">VectorPolygon</a></li><li class="api-ref"><a class="rounded" href="vectorrectangle.html">VectorRectangle</a></li><li class="api-ref"><a class="rounded" href="vectorscene.html">VectorScene</a></li><li class="api-ref"><a class="rounded" href="vectorshape.html">VectorShape</a></li><li class="api-ref"><a class="rounded" href="vectorspiral.html">VectorSpiral</a></li><li class="api-ref"><a class="rounded" href="vectortext.html">VectorText</a></li><li class="api-ref"><a class="rounded" href="vectortransition.html">VectorTransition</a></li><li class="api-ref"><a class="rounded" href="vectorviewport.html">VectorViewport</a></li><li class="api-ref"><a class="rounded" href="vectorwave.html">VectorWave</a></li></ul></div></li></ul></div></div>
<div class="col-sm-9" style="max-width: 1200px;"><div class="docs-content" style="display:none;" id="default-page"><div class="page-header"><h1>Script Class</h1></div><p class="lead">The Script class defines a common interface for script execution.</p>
<p>The Script class defines a common interface for the purpose of executing scripts, such as Fluid.  The base class does not include a default parser or execution process of any kind.</p>
<p>To execute a script file, choose a sub-class that matches the language and create the script object.  Set the <a data-bs-toggle="tooltip" title="The location of a script file to be loaded." href="#tf-Path">Path</a> field and then <a data-bs-toggle="tooltip" title="Executes the script." href="#ta-Activate">Activate()</a> the script.  Global input parameters for the script can be defined via the <a data-bs-toggle="tooltip" title="Script parameters can be set through this action." href="#ta-SetKey">SetKey()</a> action.</p>
<p>Note that client scripts may sometimes create objects that are unmanaged by the script object that created them. Terminating the script will not remove objects that are outside its resource hierarchy.</p><h3>Structure</h3><p>The Script class consists of the following fields:</p><table class="table"><thead><th class="col-md-1"><div data-bs-toggle="tooltip" title="Read/Write access indicators are listed below">Access</div></th><th class="col-md-1">Name</th><th class="col-md-1">Type</th><th>Comment</th></thead><tbody><tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-CacheFile" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-CacheFile"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">CacheFile</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>Compilable script languages can be compiled to a cache file.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-CacheFile" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>Scripts that support compilation of the source code can be compiled to a target file when the script is initialised. This file is then used as a cache, so that if the cache file exists on the next initialisation then the cache file is used instead of the original source code.</p>
<p>If the cache file exists, a determination on whether the source code has been edited is usually made by comparing date stamps on the original and cache files.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-CurrentLine" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-CurrentLine"><i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct read access"></i>
                           
                          <i class="bi bi-dash-circle-fill text-secondary" data-bs-toggle="tooltip" title="Not writeable"></i></td><th class="col-md-1">CurrentLine</th><td class="col-md-1"><span class="text-nowrap">INT</span></td><td>Indicates the current line being executed when in debug mode.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-CurrentLine" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>In debug mode, the CurrentLine will indicate the current line of execution (according to the original source code for the script).</p>
<p>It should be noted that not all script processors will support this feature, in which case the value for this field will be set to -1.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Error" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Error"><i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct read access"></i>
                           
                          <i class="bi bi-dash-circle-fill text-secondary" data-bs-toggle="tooltip" title="Not writeable"></i></td><th class="col-md-1">Error</th><td class="col-md-1"><span class="text-nowrap">ERR</span></td><td>If a script fails during execution, an error code may be readable here.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Error" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>On execution of a script, the Error value is reset to ERR::Okay and will be updated if the script fails.  Be mindful that if a script is likely to be executed recursively then the first thrown error will have priority and be propagated through the call stack.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-ErrorString" style="scroll-margin:3em;"><td class="col-md-1" id="tf-ErrorString"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">ErrorString</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>A human readable error string may be declared here following a script execution failure.</td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Flags" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Flags"><i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct read access"></i>
                           
                          <i class="bi bi-check-lg text-success" data-bs-toggle="tooltip" title="Immutable"></i></td><th class="col-md-1">Flags</th><td class="col-md-1"><span class="text-nowrap">SCF</span></td><td>Optional flags.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Flags" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th class="col-md-1">SCF::EXIT_ON_ERROR</th><td>The script will automatically terminate its execution process if an error is detected.</td></tr><tr><th class="col-md-1">SCF::LOG_ALL</th><td>Enables execution debugging.  More information will be printed to the console in this mode.</td></tr></tbody></table>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Language" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Language"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-dash-circle-fill text-secondary" data-bs-toggle="tooltip" title="Not writeable"></i></td><th class="col-md-1">Language</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>Indicates the language (locale) that the source script is written in.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Language" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>The Language value indicates the language in which the source script was written.  The default setting is <code>ENG</code>, the code for international English.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-LineOffset" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-LineOffset"><i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct read access"></i>
                           
                          <i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct write access"></i></td><th class="col-md-1">LineOffset</th><td class="col-md-1"><span class="text-nowrap">INT</span></td><td>For debugging purposes, this value is added to any message referencing a line number.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-LineOffset" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>The LineOffset is a value that is added to all line numbers that are referenced in script debugging output.  It is primarily intended for internal usage only.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Path" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Path"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">Path</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>The location of a script file to be loaded.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Path" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>A script file can be loaded by setting the Path to its location.  The path must be defined prior to the initialisation process, or alternatively the client can define the <a data-bs-toggle="tooltip" title="Scripts can be executed from any string passed into this field." href="#tf-Statement">Statement</a> field.</p>
<p>Optional parameters can also be passed to the script via the Path string.  The name of a function is passed first, surrounded by semicolons.  Arguments can be passed to the function by appending them as a CSV list.  The following string illustrates the format used: <code>dir:location;procedure;arg1=val1,arg2,arg3=val2</code></p>
<p>A target for the script may be specified by using the 'target' parameter in the parameter list (value must refer to a valid existing object).</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Procedure" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Procedure"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">Procedure</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>Specifies a procedure to be executed from within a script.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Procedure" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>Sometimes scripts are split into several procedures or functions that can be executed independently from the 'main' area of the script.  If a loaded script contains procedures, the client can set the Procedure field to execute a specific routine whenever the script is activated with the <a data-bs-toggle="tooltip" title="Executes the script." href="#ta-Activate">Activate()</a> action.</p>
<p>If this field is not set, the first procedure in the script, or the 'main' procedure (as defined by the script type) is executed by default.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Results" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Results"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">Results</th><td class="col-md-1"><span class="text-nowrap">STRING []</span></td><td>Stores multiple string results for languages that support this feature.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Results" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>If a scripting language supports the return of multiple results, this field may reflect those result values after the execution of any procedure.</p>
<p>For maximum compatibility in type conversion, the results are stored as an array of strings.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Statement" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Statement"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">Statement</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>Scripts can be executed from any string passed into this field.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Statement" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>Scripts may be compiled into a script object by setting the Statement field with a complete script string.  This is often convenient for embedding a small script into another script file without having to make external file references. It is also commonly used for executing scripts that have been embedded into program binaries.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-Target" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-Target"><i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct read access"></i>
                           
                          <i class="bi bi-check-circle-fill text-success" data-bs-toggle="tooltip" title="Direct write access"></i></td><th class="col-md-1">Target</th><td class="col-md-1"><span class="text-nowrap">OBJECTID</span></td><td>Reference to the default container that new script objects will be initialised to.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-Target" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>This field can refer to the target object that new objects at the root of the script will be initialised to.  If this field is not set, the root-level objects in the script will be initialised to the script's owner.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-TotalArgs" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-TotalArgs"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-dash-circle-fill text-secondary" data-bs-toggle="tooltip" title="Not writeable"></i></td><th class="col-md-1">TotalArgs</th><td class="col-md-1"><span class="text-nowrap">INT</span></td><td>Reflects the total number of parameters used in a script object.</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-TotalArgs" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>The total number of parameters that have been set in a script object through the unlisted field mechanism are reflected in the value of this field.</p>
      </div></div></td></tr>
<tr id="_" data-bs-toggle="collapse" data-bs-target="#fl-WorkingPath" style="scroll-margin:3em;" role="button"><td class="col-md-1" id="tf-WorkingPath"><i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional read access"></i>
                           
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" title="Functional write access"></i></td><th class="col-md-1">WorkingPath</th><td class="col-md-1"><span class="text-nowrap">STRING</span></td><td>Defines the script's working path (folder).</td></tr><tr><td colspan="4" class="hiddenRow"><div id="fl-WorkingPath" class="accordion-body collapse"><div class="doc-content" style="margin:20px">
<p>The working path for a script is defined here.  By default this is defined as the location from which the script was loaded, without the file name.  If this cannot be determined then the working path for the parent process is used (this is usually set to the location of the program).</p>
<p>The working path is always fully qualified with a slash or colon at the end of the string.</p>
<p>A client can manually change the working path by setting this field with a custom string.</p>
      </div></div></td></tr>
</tbody></table><h3>Actions</h3><p>The following actions are currently supported:</p><table class="table"><tbody><tr data-bs-toggle="collapse" data-bs-target="#tac-Activate" style="scroll-margin:3em;" id="ta-Activate"><td style="width:1%; border-top-style: none; border-bottom-style: none;"></td><th class="col-md-1 text-primary">Activate</th><td>Executes the script.</td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tac-GetKey" style="scroll-margin:3em;" id="ta-GetKey" role="button"><td style="width:1%; border-top-style: none; border-bottom-style: none;"><i class="bi bi-chevron-double-right text-secondary"></i></td><th class="col-md-1 text-primary">GetKey</th><td>Script parameters can be retrieved through this action.</td></tr><tr><td class="hiddenRow" style="width:1%; border-top-style: none; border-bottom-style: none;"></td><td colspan="2" class="hiddenRow"><div id="tac-GetKey" class="collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR acGetKey(*Object, CSTRING Key, STRING Value, LONG Size)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Key</td><td>The name of a key value.</td></tr><tr><td>Value</td><td>Pointer to a buffer space large enough to hold the retrieved value.</td></tr><tr><td>Size</td><td>Indicates the byte size of the Buffer.</td></tr></tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;"></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tac-Reset" style="scroll-margin:3em;" id="ta-Reset"><td style="width:1%; border-top-style: none; border-bottom-style: none;"></td><th class="col-md-1 text-primary">Reset</th><td>Resets an object to its original state.</td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tac-SetKey" style="scroll-margin:3em;" id="ta-SetKey" role="button"><td style="width:1%; border-top-style: none; border-bottom-style: none;"><i class="bi bi-chevron-double-right text-secondary"></i></td><th class="col-md-1 text-primary">SetKey</th><td>Script parameters can be set through this action.</td></tr><tr><td class="hiddenRow" style="width:1%; border-top-style: none; border-bottom-style: none;"></td><td colspan="2" class="hiddenRow"><div id="tac-SetKey" class="collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR acSetKey(*Object, CSTRING Key, CSTRING Value)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Key</td><td>The name of the target key.</td></tr><tr><td>Value</td><td>The string value to associate with Key.</td></tr></tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;"></div></div></td></tr>
</tbody></table><h3>Methods</h3><p>The following methods are currently supported:</p><table class="table"><tbody><tr data-bs-toggle="collapse" data-bs-target="#tmx-Callback" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">Callback</th><td id="tm-Callback">An internal method for managing callbacks.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-Callback" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR sc::Callback(OBJECTPTR Object, LARGE ProcedureID, const struct ScriptArg * Args, LONG TotalArgs, ERR * Error)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>ProcedureID</td><td>An identifier for the target procedure.</td></tr><tr><td>Args</td><td>Optional CSV string containing parameters to pass to the procedure.</td></tr><tr><td>TotalArgs</td><td>The total number of parameters in the Args parameter.</td></tr><tr><td>Error</td><td>The error code returned from the script, if any.</td></tr></tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>Private</p>
      <div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>Operation successful.</td></tr><tr><th class="col-md-1">Args</th><td>Invalid arguments passed to function.</td></tr></tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-DerefProcedure" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">DerefProcedure</th><td id="tm-DerefProcedure">Dereferences a function.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-DerefProcedure" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR sc::DerefProcedure(OBJECTPTR Object, FUNCTION * Procedure)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Procedure</td><td>The function to be dereferenced.</td></tr></tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>This method is applicable to scripting languages that manage function references as a keyed resource.  Fluid is one such language.</p>
<p>Any routine that accepts a script function as a parameter should call DerefProcedure at a later point in order to ensure that the function reference is released.  Not doing so may leave the reference in memory until the Script that owns the procedure is terminated.</p>
      <div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>Operation successful.</td></tr><tr><th class="col-md-1">NullArgs</th><td>Function call missing argument value(s)</td></tr></tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-Exec" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">Exec</th><td id="tm-Exec">Executes a procedure in the script.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-Exec" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR sc::Exec(OBJECTPTR Object, CSTRING Procedure, const struct ScriptArg * Args, LONG TotalArgs)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Procedure</td><td>The name of the procedure to execute, or NULL for the default entry point.</td></tr><tr><td>Args</td><td>Optional parameters to pass to the procedure.</td></tr><tr><td>TotalArgs</td><td>Total number of <code>Args</code> provided.</td></tr></tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>Use the Exec() method to execute a named procedure in a script, optionally passing that procedure a series of parameters.</p>
<p>The behaviour of this process matches that of the <a data-bs-toggle="tooltip" title="Executes the script." href="#ta-Activate">Activate()</a> action and will return the same error codes in the event of failure.  If the <code>Procedure</code> returns results, they will be available from the <a data-bs-toggle="tooltip" title="Stores multiple string results for languages that support this feature." href="#tf-Results">Results</a> field after execution.</p>
<p>Parameter values must be specified as an array of ScriptArg structures.  The following example illustrates:</p>
<pre>
struct ScriptArg args[] = {
   { "Object",       FD_OBJECTID, { .Long = Self-&gt;UID } },
   { "Output",       FD_PTR,      { .Address = output } },
   { "OutputLength", FD_LONG,     { .Long = len } }
};
</pre>
<p>The ScriptArg structure follows this arrangement:</p>
<pre>
struct ScriptArg {
   STRING Name;
   LONG Type;
   union {
      APTR   Address;
      LONG   Long;
      LARGE  Large;
      DOUBLE Double;
   };
};
</pre>
<p>The Field Descriptor <code>FD</code> specified in the <code>Type</code> must be a match to whatever value is defined in the union.  For instance if the <code>Long</code> field is defined then an <code>FD_LONG</code> <code>Type</code> must be used.  Supplementary field definition information, e.g. <code>FD_OBJECT</code>, may be used to assist in clarifying the type of the value that is being passed.  Field Descriptors are documented in detail in the Parasol Wiki.</p>
      <div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>The procedure was executed.</td></tr><tr><th class="col-md-1">Args</th><td>The <code>TotalArgs</code> value is invalid.</td></tr><tr><th class="col-md-1">NullArgs</th><td>Function call missing argument value(s)</td></tr></tbody></table></div></div></td></tr>
<tr data-bs-toggle="collapse" data-bs-target="#tmx-GetProcedureID" role="button" style="scroll-margin:3em;"><th class="col-md-1 text-primary">GetProcedureID</th><td id="tm-GetProcedureID">Converts a procedure name to an ID.</td></tr><tr><td colspan="2" class="hiddenRow"><div id="tmx-GetProcedureID" class="accordion-body collapse"><div class="card" style="border-radius: 0;"><div class="card-header action-header" style="border-radius: 0;"><samp>ERR sc::GetProcedureID(OBJECTPTR Object, CSTRING Procedure, LARGE * ProcedureID)</samp></div><div class="card-body" style="padding:0px"><table class="table"><thead><tr><th class="col-md-1">Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Procedure</td><td>The name of the procedure.</td></tr><tr><td>ProcedureID</td><td>The computed ID will be returned in this parameter.</td></tr></tbody></table></div></div><div class="docs-content" style="margin:1em .5em 1em .5em;">
<p>This method will convert a procedure name to a unique reference that will be recognised by the script as a direct reference to that procedure.  The ID can be used to create new <code>FUNCTION</code> definitions, for example:</p>
<pre>FUNCTION callback;
SET_FUNCTION_SCRIPT(callback, script, procedure_id);
</pre>
<p>Resolving a procedure will often result in the Script maintaining an ongoing reference for it.  To discard the reference, call <a data-bs-toggle="tooltip" title="Dereferences a function." href="#tm-DerefProcedure">DerefProcedure()</a> once access to the procedure is no longer required.  Alternatively, destroying the script will also dereference all procedures.</p>
      <div class="sub-header">Error Codes</div><table class="table table-sm borderless"><tbody><tr><th class="col-md-1">Okay</th><td>Operation successful.</td></tr><tr><th class="col-md-1">NullArgs</th><td>Function call missing argument value(s)</td></tr></tbody></table></div></div></td></tr>
</tbody></table><div class="footer copyright text-right">Script class documentation © Paul Manias 1996-2025</div></div><div class="docs-content" style="display:none;" id="SCF"><h1>SCF Type</h1><p class="lead">Script flags</p><table class="table"><thead><tr><th class="col-md-1">Name</th><th>Description</th></tr></thead><tbody><tr><th>SCF::EXIT_ON_ERROR</th><td>The script will automatically terminate its execution process if an error is detected.</td></tr><tr><th>SCF::LOG_ALL</th><td>Enables execution debugging.  More information will be printed to the console in this mode.</td></tr></tbody></table><div class="footer copyright text-right">Script module documentation © Paul Manias 1996-2025</div></div>
</div></div></div><script src="../../js/bootstrap.bundle.min.js"></script><script src="../../js/base.js"></script><script>
const ready = fn => document.readyState !== 'loading' ? fn() : document.addEventListener('DOMContentLoaded', fn);

   var xslt = false;
   var url = window.location.pathname;
   var filename = url.substring(url.lastIndexOf('/')+1);
   if (filename.endsWith(".xml")) { // XSLT is being used to view this document
      filename = filename.substr(0, filename.length-3) + 'html';
      xslt = true;
   }

   // Auto-open the relevant sidebar branch

   var nl = document.querySelectorAll('li[class="api-ref"] > a[href="' + filename + '"]');
   if (nl.length > 0) {
      // Target the last matching element to avoid confusion with matching module names (e.g. Audio module == Audio class)
      var el = nl.item(nl.length-1)
      var parent = getParentNode(el, '[class="collapse"]');
      if (parent) new bootstrap.Collapse(parent, { show: true }); // Causes animation

      el.style.backgroundColor = '#d2f4ea';
   }

   var page = glParameters["page"];
   if (isEmpty(page)) page = glParameters["function"];
   var div = document.getElementById(page);
   if (!div) div = document.getElementById("default-page");
   if (div) div.style.display = "block";

   cancelAnimations();

ready(function(){
   // Initialise tooltips
   var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
   var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
     return new bootstrap.Tooltip(tooltipTriggerEl)
   })

   // In XSLT mode, changing all HTML links to XML is helpful for navigation (if heavy handed)
   if (xslt) {
      var nl = document.querySelectorAll('a[href*=".html"]');
      nl.forEach((el) => {
         el.href = el.href.substr(0, el.href.length-5) + '.xml'
      })
   }
});

         </script></body></html>
