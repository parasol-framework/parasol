-- Arrow function syntax tests

function testArrowSingleParam()
   local double = i => i * 2
   assert(double(5) is 10)
end

function testArrowMultipleParams()
   local add = (a, b) => a + b
   assert(add(3, 4) is 7)
end

function testArrowNoParams()
   local constant = () => 42
   assert(constant() is 42)
end

function testArrowThreeParams()
   local sum3 = (x, y, z) => x + y + z
   assert(sum3(1, 2, 3) is 6)
end

function testArrowBlockForm()
   local process = i => do
      local doubled = i * 2
      return doubled + 1
   end
   assert(process(5) is 11)
end

function testArrowWithEach()
   local sum = 0
   local r = {1..6}
   r:each(i => do sum += i end)
   assert(sum is 15)
end

function testArrowClosure()
   local multiplier = 3
   local fn = i => i * multiplier
   assert(fn(4) is 12)
end

function testArrowNested()
   local make_adder = n => (x => x + n)
   local add5 = make_adder(5)
   assert(add5(10) is 15)
end

function testArrowComparison()
   local items = {3, 1, 2}
   table.sort(items, (a, b) => a < b)
   assert(items[0] is 1)
   assert(items[1] is 2)
   assert(items[2] is 3)
end

return {
   tests = {
      'testArrowSingleParam',
      'testArrowMultipleParams',
      'testArrowNoParams',
      'testArrowThreeParams',
      'testArrowBlockForm',
      'testArrowWithEach',
      'testArrowClosure',
      'testArrowNested',
      'testArrowComparison'
   }
}
